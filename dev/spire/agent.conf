agent {
  data_dir   = "/opt/spire/data/agent"
  log_level  = "DEBUG"
  trust_domain = "cluster.local"

  server_address = "spire-server"
  server_port    = "8081"

  # Workload API socket — svid-exchange reads SVIDs from here.
  socket_path = "/opt/spire/sockets/agent.sock"

  # insecure_bootstrap skips bundle verification on first dial.
  # Safe for local dev; NEVER use in production — use trust_bundle_path instead.
  insecure_bootstrap = true
}

plugins {
  # Must match the server's NodeAttestor.
  NodeAttestor "join_token" {
    plugin_data {}
  }

  # memory: agent keys are ephemeral (fine for dev; use disk for prod).
  KeyManager "memory" {
    plugin_data {}
  }

  # unix: attests workloads by UID/GID/PID of the connecting process.
  WorkloadAttestor "unix" {
    plugin_data {}
  }
}

health_checks {
  listener_enabled = true
  bind_address     = "0.0.0.0"
  bind_port        = "8082"
  live_path        = "/live"
  ready_path       = "/ready"
}
